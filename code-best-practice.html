
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Code in Style &#8212; Coding for Economists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-9FZQCPFXZJ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-9FZQCPFXZJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-9FZQCPFXZJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'code-best-practice';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://aeturrell.github.io/coding-for-economists/code-best-practice.html" />
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coding" href="code-advanced.html" />
    <link rel="prev" title="Spreadsheets" href="data-spreadsheets.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/smith_lovelace.png" class="logo__image only-light" alt="Coding for Economists - Home"/>
    <script>document.write(`<img src="_static/smith_lovelace.png" class="logo__image only-dark" alt="Coding for Economists - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="code-preliminaries.html">Preliminaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-basics.html">Coding Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow-basics.html">Workflow Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-where.html">Writing Code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Essential Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data-analysis-quickstart.html">Data Analysis Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-intro.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-transformation.html">Data Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-read-and-write.html">Reading and Writing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-numbers.html">Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-categorical.html">Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-spreadsheets.html">Spreadsheets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Essential Coding</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Code in Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-advanced.html">Coding</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-advcd-best-practice.html">Shortcuts to Better Coding</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Essential Data Visualisation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vis-intro.html">Intro to Data Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-letsplot.html">Easy Data Visualisation for Tidy Data with <strong>Lets-Plot</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-matplotlib.html">Powerful Data Visualisation with <strong>Matplotlib</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-common-plots-one.html">Common Plots I</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-common-plots-two.html">Common Plots II</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Essential Workflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="auto-research-outputs.html">Automating Research Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrkflow-markdown.html">Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrkflow-command-line.html">The Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrkflow-version-control.html">Version Control</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Econometrics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="econmt-probability-random.html">Probability and Random Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-regression.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-generalised-models.html">Generalised regression models</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-diagnostics.html">Regression diagnostics and visualisations</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-causal-inference.html">Causal Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-bayesian.html">Bayesian Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="econmt-bayes-bambi.html">Bayesian Inference Made Easier</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data-boolean.html">Boolean Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-joining-data.html">Joins</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-missing-values.html">Missing Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-exploratory-analysis.html">Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-extraction.html">Getting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-advanced.html"><strong>pandas</strong> alternatives, validation, and orchestration</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-sharing.html">Sharing Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="code-further-advanced.html">Advanced Coding</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualisation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vis-narrative.html">Narrative Data Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-tables.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-dashboards.html">Dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-animation.html">Animation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Workflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="wrkflow-quarto.html">Combining Code and Text in Quarto Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrkflow-environments.html">Virtual Code Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrkflow-rap.html">Reproducible Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Time</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="time-intro.html">Introduction to Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="time-series.html">Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="time-fcasts-env.html">Forecasting Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="text-intro.html">Introduction to Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="text-regex.html">Regular Expressions, aka regex</a></li>
<li class="toctree-l1"><a class="reference internal" href="text-nlp.html">Natural Language Processing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ml-intro.html">Introduction to Machine Learning and AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml-sup.html">Supervised Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml-data.html">Data for Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml-unsup.html">Unsupervised Machine Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Geospatial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="geo-intro.html">Intro to Geo-Spatial Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="geo-vis.html">Geo-Spatial Visualisation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathematics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="maths-abstract.html">Abstract Mathematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="maths-numerical.html">Numerical Mathematics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Craft</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="craft-intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-search.html">Putting the Search in Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-generating-ideas.html">Generating and Accepting Research Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-writing-papers.html">Writing Papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-research-blogs.html">Research Blog Posts</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-referee.html">Writing Referee Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-technical-reports.html">Writing Technical Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="craft-extended-abstracts.html">Extended Abstracts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Data Visualisation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vis-plotnine.html">Data Visualisation using the Grammar of Graphics with <strong>Plotnine</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-seaborn.html">Data Visualisation with <strong>Seaborn</strong></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coming from ...</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="coming-from-stata.html">Coming from Stata</a></li>
<li class="toctree-l1"><a class="reference internal" href="coming-from-matlab.html">Coming from Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="coming-from-r.html">Coming from R</a></li>
<li class="toctree-l1"><a class="reference internal" href="coming-from-excel.html">Coming from Excel</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">End Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/aeturrell/coding-for-economists/blob/main/code-best-practice.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/aeturrell/coding-for-economists" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/aeturrell/coding-for-economists/issues/new?title=Issue%20on%20page%20%2Fcode-best-practice.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/code-best-practice.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="_sources/code-best-practice.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Code in Style</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-code-in-style">How to Code in Style</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-in-a-name">What’s in a name?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whitespace">Whitespace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-width-and-line-continuation">Line width and line continuation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principles-of-clean-code">Principles of Clean Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-not-repeat-yourself-dry">Do not repeat yourself (DRY)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kiss-keep-it-simple-stupid">KISS (Keep It Simple, Stupid)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#soc-separation-of-concerns-make-it-modular">SoC (Separation of Concerns) / Make it Modular</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-comments">Code Comments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-review">Code Review</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-prematurely-optimise-for-speed">Don’t prematurely optimise for speed</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-interoperable-file-formats">Use interoperable file formats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-relative-filepaths">Use relative filepaths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rubber-duck-your-problems">Rubber duck your problems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-zen-of-python">The Zen of Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-coding-tips">Advanced Coding Tips</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#version-control">Version Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#environments">Environments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-management">Project management</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review">Review</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="code-in-style">
<span id="code-best-practice"></span><h1>Code in Style<a class="headerlink" href="#code-in-style" title="Link to this heading">#</a></h1>
<p>In this chapter, you’ll learn some of the easiest and most impactful tips for better coding. This chapter has benefitted from the <a class="reference external" href="https://testdriven.io/blog/clean-code-python/">Clean Code In Python</a> guide by Nik Tomazic and the UK Government Statistical Service’s <a class="reference external" href="https://best-practice-and-impact.github.io/qa-of-code-guidance/intro.html">Quality Assurance of Code for Analysis and Research</a> guidance (which is well worth checking out).</p>
<p>As this is the bare bones of best practice coding, we won’t cover some very important but more complex topics, such as reproducibility, testing, and version control, here.</p>
<p>There are many ways to write equally valid code and, over the years, software developers have worked out ways that help to make writing, using, debugging, and reading code more fun and certainly more efficient. <strong>Following these best practice tips will save you hours and <em>hours</em> of time.</strong></p>
<p><img alt="Code quality 2" src="https://imgs.xkcd.com/comics/code_quality_2.png" /></p>
<p>Remember, most of the time, you are going to be writing code that someone else will read (most probably it will be future you), or that you’ll need to run again. So you may think that by cutting out some of these practices that you’ll save time, but it depends how heavily you discount your future time! It’s almost always worth it to follow best practices.</p>
<p>If you follow the guidelines in this chapter you will find that your code will be:</p>
<ul class="simple">
<li><p>easier to understand</p></li>
<li><p>more efficient</p></li>
<li><p>easier to maintain, scale, debug, and refactor</p></li>
</ul>
<section id="how-to-code-in-style">
<h2>How to Code in Style<a class="headerlink" href="#how-to-code-in-style" title="Link to this heading">#</a></h2>
<p>The first thing to think about is code style, ie the way you write equivalent valid code.</p>
<p>Don’t worry if this all seems like a lot to take in though, because in <a class="reference internal" href="code-advcd-best-practice.html#code-advcd-best-practice"><span class="std std-ref">Shortcuts to Better Coding</span></a> we’ll find out how to get the computer to apply style to your code <em>automatically</em>.</p>
<p>Python has a whole set of conventions about good style called <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">‘PEP8’</a>, which it’s worth taking a quick look at. It includes advice like indentation should always be 4 spaces (not tabs) per level and that you should surround top-level function and class definitions with two blank lines.</p>
<p>Most programming languages have a style guide, or at least some conventions! PEP8 is not the only Python style guide around: another popular one is the <a class="reference external" href="https://google.github.io/styleguide/pyguide.html">Google style guide</a>. But PEP8 is the most popular.</p>
<p>Learning <em>all</em> of the PEP8 conventions would be tedious beyond belief. The good news is that a combination of packages and Visual Studio Code will do a lot of them for you. Packages can re-style and even re-write your code automatically (more on that in Chapter on <a class="reference internal" href="code-advcd-best-practice.html#code-advcd-best-practice"><span class="std std-ref">Shortcuts to Better Coding</span></a>).</p>
<p><img alt="Code quality" src="https://imgs.xkcd.com/comics/code_quality.png" /></p>
<section id="what-s-in-a-name">
<h3>What’s in a name?<a class="headerlink" href="#what-s-in-a-name" title="Link to this heading">#</a></h3>
<p>First, names matter. Use meaningful names for variables, functions, or whatever it is you’re naming. Avoid abbreviations that you understand <em>now</em> but which will be unclear to others, or future you. For example, use <code class="docutils literal notranslate"><span class="pre">real_wage_hourly</span></code> over <code class="docutils literal notranslate"><span class="pre">re_wg_ph</span></code>. I know it’s tempting to use <code class="docutils literal notranslate"><span class="pre">temp</span></code> but you’ll feel silly later when you can’t for the life of you remember what <code class="docutils literal notranslate"><span class="pre">temp</span></code> does or is. A good trick when naming booleans (variables that are either true or false) is to use <code class="docutils literal notranslate"><span class="pre">is</span></code> followed by what the boolean variable refers to, for example <code class="docutils literal notranslate"><span class="pre">is_married</span></code>.</p>
<p>As well as this general tip, Python has conventions on naming different kinds of variables. The naming convention for almost all objects is lower case separated by underscores, e.g. <code class="docutils literal notranslate"><span class="pre">a_variable=10</span></code> or ‘this_is_a_script.py’. This style of naming is also known as snake case. There are different naming conventions though—<a class="reference external" href="https://twitter.com/allison_horst">Allison Horst</a> made this fantastic cartoon of the different conventions that are in use.</p>
<p><img alt="Different naming conventions. Artwork by &#64;allison_horst." src="https://github.com/aeturrell/coding-for-economists/raw/main/img/in_that_case.jpg" /> Different naming conventions. Artwork by &#64;allison_horst.</p>
<p>There are three exceptions to the snake case convention in Python: classes, which should be in camel case, eg <code class="docutils literal notranslate"><span class="pre">ThisIsAClass</span></code>; constants, which are in capital snake case, eg <code class="docutils literal notranslate"><span class="pre">THIS_IS_A_CONSTANT</span></code>; and packages, which are typically without spaces or underscores and are lowercase <code class="docutils literal notranslate"><span class="pre">thisisapackage</span></code>.</p>
<p>For some quick shortcuts to re-naming columns in <strong>pandas</strong> dataframes or string variables, try the unicode-friendly <a class="reference external" href="https://github.com/un33k/python-slugify"><strong>slugify</strong></a> library or the <code class="docutils literal notranslate"><span class="pre">clean_columns()</span></code> function from the <a class="reference external" href="https://aeturrell.github.io/skimpy"><strong>skimpy</strong></a> library.</p>
<p>The better named your variables, the clearer your code will be–and the fewer comments you will need to write!</p>
<p>In summary:</p>
<ul>
<li><p>use descriptive variable names that reveal your intention, eg <code class="docutils literal notranslate"><span class="pre">days_since_treatment</span></code></p></li>
<li><p>avoid using ambiguous abbreviations in names, eg use <code class="docutils literal notranslate"><span class="pre">real_wage_hourly</span></code> over <code class="docutils literal notranslate"><span class="pre">rw_ph</span></code></p></li>
<li><p>always use the same vocabulary, eg don’t switch from <code class="docutils literal notranslate"><span class="pre">worker_type</span></code> to <code class="docutils literal notranslate"><span class="pre">employee_type</span></code></p></li>
<li><p>avoid ‘magic numbers’, eg numbers in your code that set a key parameter. Set these as named constants instead. Here’s an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

  <span class="c1"># This is bad</span>
  <span class="k">def</span><span class="w"> </span><span class="nf">roll</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>  <span class="c1"># magic number!</span>

  <span class="c1"># This is good</span>
  <span class="n">MAX_INT_VALUE</span> <span class="o">=</span> <span class="mi">36</span>

  <span class="k">def</span><span class="w"> </span><span class="nf">roll</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MAX_INT_VALUE</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>use verbs for function names, eg <code class="docutils literal notranslate"><span class="pre">get_regression()</span></code></p></li>
<li><p>use consistent verbs for function names, don’t use <code class="docutils literal notranslate"><span class="pre">get_score()</span></code> and <code class="docutils literal notranslate"><span class="pre">grab_results()</span></code> (instead use <code class="docutils literal notranslate"><span class="pre">get()</span></code> for both)</p></li>
<li><p>variable names should be snake_case and all lowercase, eg <code class="docutils literal notranslate"><span class="pre">first_name</span></code></p></li>
<li><p>class names should be CamelCase, eg <code class="docutils literal notranslate"><span class="pre">MyClass</span></code></p></li>
<li><p>function names should be snake_case and all lowercase, eg <code class="docutils literal notranslate"><span class="pre">quick_sort()</span></code></p></li>
<li><p>constants should be snake_case and all uppercase, eg <code class="docutils literal notranslate"><span class="pre">PI</span> <span class="pre">=</span> <span class="pre">3.14159</span></code></p></li>
<li><p>modules should have short, snake_case names and all lowercase, eg <code class="docutils literal notranslate"><span class="pre">pandas</span></code></p></li>
<li><p>single quotes and double quotes are equivalent so pick one and be consistent—most automatic formatters prefer <code class="docutils literal notranslate"><span class="pre">&quot;</span></code></p></li>
</ul>
</section>
<section id="whitespace">
<h3>Whitespace<a class="headerlink" href="#whitespace" title="Link to this heading">#</a></h3>
<p>Surrounding bits of code with whitespace can significantly enhance readability. One such convention is that functions should have two blank lines following their last line. Another is that assignments are separated by spaces</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">this_is_a_var</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>whereas keyword arguments in functions do not have spaces</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input_one</span><span class="p">,</span> <span class="n">input_two</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">input_one</span>
</pre></div>
</div>
<p>Another convention is that a space appears after a <code class="docutils literal notranslate"><span class="pre">,</span></code>, for example in the definition of a list we would have</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">list_var</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>rather than</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">list_var</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="c1"># or</span>
<span class="n">list_var</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>There are packages that can re-organise your whitespace for you; these are featured in the Chapter on <a class="reference internal" href="code-advcd-best-practice.html#code-advcd-best-practice"><span class="std std-ref">Shortcuts to Better Coding</span></a>.</p>
<p>In summary,</p>
<ul class="simple">
<li><p>indent using 4 spaces (spaces are preferred over tabs)</p></li>
<li><p>lines should not be longer than 79 characters</p></li>
<li><p>avoid multiple statements on the same line</p></li>
<li><p>top-level function and class definitions are surrounded with two blank lines</p></li>
<li><p>method definitions inside a class are surrounded by a single blank line</p></li>
<li><p>imports should be on separate lines</p></li>
</ul>
</section>
<section id="line-width-and-line-continuation">
<h3>Line width and line continuation<a class="headerlink" href="#line-width-and-line-continuation" title="Link to this heading">#</a></h3>
<p>For quite arbitrary historical reasons, PEP8 also suggests 79 characters for each line of code. Some find this too restrictive, especially with the advent of wider monitors. But it is good to split up very long lines. Anything that is contained in parenthesis can be split into multiple lines like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input_one</span><span class="p">,</span> <span class="n">input_two</span><span class="p">,</span>
             <span class="n">input_three</span><span class="p">,</span> <span class="n">input_four</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_one</span><span class="p">,</span>
              <span class="o">+</span> <span class="n">input_two</span><span class="p">,</span>
              <span class="o">+</span> <span class="n">input_three</span><span class="p">,</span>
              <span class="o">+</span> <span class="n">input_four</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Again, automatic formatters, which we’ll meet in the <a class="reference internal" href="code-advcd-best-practice.html#code-advcd-best-practice"><span class="std std-ref">Shortcuts to Better Coding</span></a> Chapter, will try and break up long lines for you.</p>
</section>
</section>
<section id="principles-of-clean-code">
<h2>Principles of Clean Code<a class="headerlink" href="#principles-of-clean-code" title="Link to this heading">#</a></h2>
<p>While automation can help apply style, it can’t help you write <em>clean code</em>. Clean code is a set of rules and principles that helps to keep your code readable, maintainable, and extendable. Writing code is easy; writing clean code is hard! However, if you follow these principles, you won’t go far wrong.</p>
<section id="do-not-repeat-yourself-dry">
<h3>Do not repeat yourself (DRY)<a class="headerlink" href="#do-not-repeat-yourself-dry" title="Link to this heading">#</a></h3>
<p>The DRY principle is ‘Every piece of knowledge or logic must have a single, unambiguous representation within a system.’ Divide your code into re-usable pieces that you can call when and where you want. Don’t write lengthy methods, but divide logic up into clearly differentiated chunks.</p>
<p>This saves having to repeat code, having no idea whether it’s this or that version of the same function doing the work, and will help your debugging efforts no end.</p>
<p>Some practical ways to apply DRY in practice are to use functions, to put functions or code that needs to be executed multiple times by multiple different scripts into another script (eg called <code class="docutils literal notranslate"><span class="pre">text_cleaning_utilities.py</span></code>) and then import it, and to think carefully if another way of writing your code would be more concise (yet still readable).</p>
<div class="tip admonition">
<p class="admonition-title">Tip</p>
<p>If you’re using Visual Studio Code, you can <a class="reference external" href="https://code.visualstudio.com/docs/editor/refactoring">automatically send code into a function</a> by right-clicking on code and using the ‘Extract to method’ option.</p>
</div>
</section>
<section id="kiss-keep-it-simple-stupid">
<h3>KISS (Keep It Simple, Stupid)<a class="headerlink" href="#kiss-keep-it-simple-stupid" title="Link to this heading">#</a></h3>
<p>Most systems work best if they are kept simple, rather than made complicated. This is a rule that says you should avoid unnecessary complexity. If your code is complex, it will only make it harder for you to understand what you did when you come back to it later.</p>
</section>
</section>
<section id="soc-separation-of-concerns-make-it-modular">
<h2>SoC (Separation of Concerns) / Make it Modular<a class="headerlink" href="#soc-separation-of-concerns-make-it-modular" title="Link to this heading">#</a></h2>
<p>Depending on your project, it’s usually best to not have a single file that does everything. If you split your code into separate, independent modules it will be easier to read, debug, test, and use. You can check the basics of coding chapter to see how to create and import functions from other scripts. But even within a script, you can still make your code modular by defining functions that have clear inputs and outputs.</p>
<p>A good rule of thumb is that if a code that achieves one end goes longer than about 30 lines, it should probably go into a function. Scripts longer than about 500 lines are ripe for splitting up too.</p>
<p>Relatedly, do not have a single function that tries to do everything. Functions should have limits too; they should do approximately one thing. If you’re naming a function and you have to use ‘and’ in the name then it’s probably worth splitting it into two functions.</p>
<p>Functions should have no ‘side effects’ either; that is, they shouldn’t only take in value(s), and output value(s) via a return statement. They shouldn’t modify global variables or make other changes.</p>
<p>Another good rule of thumb is that each function shouldn’t have lots of separate arguments.</p>
<p>A final tip for modularity and the creation of functions is that you shouldn’t use ‘flags’ in functions (aka boolean conditions). Here’s an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is bad</span>
<span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">uppercase</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">uppercase</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1"># This is good</span>
<span class="k">def</span><span class="w"> </span><span class="nf">uppercase</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lowercase</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="code-comments">
<h2>Code Comments<a class="headerlink" href="#code-comments" title="Link to this heading">#</a></h2>
<p>Code comments (extra information that is not executed when the code is run) can be added by a preceding hash character <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">This</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">comment</span></code>. Use code comments to provide extra contextual information that <em>isn’t</em> conveyed by function and variable names.</p>
<p>Actually, well-written code needs <em>fewer</em> comments because you make what’s going on <em>more</em> evident to the reader. And it’s tempting not to update comments even when code changes. So do comment, but see if you can make the code tell its own story first.</p>
<p>Also, avoid “noise” comments that tell you what you already know from just looking at the code.</p>
<p><img alt="Picture of a cat wearing a label that says cat" src="https://i.postimg.cc/t4SV5NQg/catto.png" /></p>
<p>Finally, functions come with their own special type of comments called a doc string. Here’s an example that tells us all about the functions inputs and outputs, including the type of input and output (here a dataframe, also known as <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">round_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rounds numeric columns in dataframe to 2 s.f.</span>
<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Input dataframe</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Dataframe with numbers rounded to 2 s.f.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">):</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">:</span><span class="s1">g</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
<section id="code-review">
<h3>Code Review<a class="headerlink" href="#code-review" title="Link to this heading">#</a></h3>
<p>Perform code reviews: give what you’ve done to a colleague and ask them to go through it line-by-line to check it works as intended. If they do this properly and don’t find any mistakes or issues then I’d be very surprised. Return the favour to magically become a better coder yourself.</p>
</section>
<section id="don-t-prematurely-optimise-for-speed">
<h3>Don’t prematurely optimise for speed<a class="headerlink" href="#don-t-prematurely-optimise-for-speed" title="Link to this heading">#</a></h3>
<p>Make code correct and readable first, and fast second. You can waste a lot of time optimising only to find that either the bottleneck is not where you thought it was, or that you change your mind about what process needs to be done.</p>
</section>
<section id="use-interoperable-file-formats">
<h3>Use interoperable file formats<a class="headerlink" href="#use-interoperable-file-formats" title="Link to this heading">#</a></h3>
<p>We’ll talk much more about data in an upcoming chapter. For now, some basic pointers for the most common form of data: tabular data that’s arranged in columns and rows.</p>
<p>First: <strong>do not</strong> store your data in Excel file formats. Ever. First, it’s not an open format, it’s proprietary, even if you can open it with many open source tools. Second, more importantly, Excel can do bad things like <a class="reference external" href="http://www.win-vector.com/blog/2014/11/excel-spreadsheets-are-hard-to-get-right/">changing the underlying values in your dataset</a> (dates and booleans), and it tempts other users to start slotting Excel code around the data. This is bad - best practice is to <strong>separate</strong> code and data. Code hidden in Excel cells is not very transparent or auditable.</p>
<p><img alt="jpg" src="https://pbs.twimg.com/media/D8z-M_dVUAA6NOh?format=jpg&amp;name=medium" /></p>
<p>If you want examples of what can go wrong using Excel, look no further than the famous <a class="reference external" href="https://theconversation.com/the-reinhart-rogoff-error-or-how-not-to-excel-at-economics-13646">Reinhart and Rogoff Excel error</a>, where they didn’t select all cells (it’s harder to make this kind of mistake with real programming languages, though of course not impossible), the time when a first-year law associate <a class="reference external" href="https://www.abajournal.com/news/article/excel_error_by_a_cleary_gottlieb_associate_alters_lehman_asset_deal1">added an extra 179 contracts</a> to an agreement to buy Lehman Brothers assets, or when the UK <a class="reference external" href="https://www.bbc.co.uk/news/technology-54423988">under-counted the number</a> of coronavirus cases by <em>16,000</em> because their Excel spreadsheet wasn’t big enough. In programming, the dataset limitation is the size of your computer’s hard drive (and even then, you can jump onto the cloud).</p>
<p>In the majority of cases, the best data file format for your project is CSV–certainly for outputting final results. Everyone can open a CSV file, no matter what analytical tool or operating system they are using. As a storage format, it’s unlikely to change. Without going into the mire of <a class="reference external" href="http://kunststube.net/encoding/">different encodings</a>, save it with the UTF-8 encoding (note that this is not the default encoding in Windows).</p>
<p>Do not use Stata’s .dta format for storing data, especially long term. For one thing, the format changes with the version of Stata. You do not want your data to depend on what version of software you’re using! Second, it isn’t very interoperable across tools (although you can use <code class="docutils literal notranslate"><span class="pre">pd.read_stata()</span></code> in Python). Third, it is not very efficient in the way that it uses disk space.</p>
<p>Although open source and compressed, I also don’t recommend the statistical language R’s RDS format or Python’s pickle format, because neither are easily accessible from other tools. These are okay for intermediate data within a project that won’t persist, but you could also use parquet for that, which is cross-platform.</p>
<p>And if you’re working with big data, I <em>strongly</em> recommend the parquet file format. In most programming languages, it’s <a class="reference external" href="https://ursalabs.org/blog/2019-10-columnar-perf/">blazing fast</a> for input/output and packs down to a very efficient size. For example, a file saved in parquet might be 10 times smaller than the same .dta file; in tests, a 114 Mb parquet file was a whopping 4.68 GB in R’s RDS format. If you’re using cloud or have a small laptop, these space-savings add up. Better yet, parquet is available across a wide range of tools and languages including Python, R, Ruby, C++, Java, and Go. (Worth saying that parquet won’t always be the right choice, but it’s a great default for big data.)</p>
</section>
<section id="use-relative-filepaths">
<h3>Use relative filepaths<a class="headerlink" href="#use-relative-filepaths" title="Link to this heading">#</a></h3>
<p>A path, or filepath, is a slash-separated list of directory names followed by either a directory name or a file name. You’ll use them to read data into code, for example using <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">pd.read_csv('path/to/data.csv')</span></code>. A directory is the same as a folder. On Unix based systems (Mac and Linux), these paths use forward slashes:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/Users/yourname/Documents/projects/file.csv
</pre></div>
</div>
<p>On Windows, which insists on being different, the slashes go the other way:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C:<span class="se">\D</span>ocuments<span class="se">\p</span>rojects<span class="se">\f</span>ile.csv
</pre></div>
</div>
<p>These are <em>absolute paths</em>, that is they give the full information to go from a disk to the file. These are okay on your computer, but they are useless for replicability or for working with co-authors. It’s much better in that case to use <em>relative paths</em>, where the path to a file is defined relative to a project folder. For example,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>project_folder/data/raw/file.csv
</pre></div>
</div>
<p>Then, we use the convention that code executed for a project should have the project folder as its root directory, and any paths are relative to it. So to open <code class="docutils literal notranslate"><span class="pre">file.csv</span></code> using <strong>pandas</strong>, you would use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/raw/file.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This works great on Mac and Linux, but it’s not going to work on Windows; Windows uses backwards slashes, and back slashes unfortunately tend to do other things in programming too. To ensure relative paths work <em>across</em> operating systems, the best way is to wrap the file path in a call to the <code class="docutils literal notranslate"><span class="pre">Path()</span></code> method in the <strong>pathlib</strong> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">path_to_data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data/raw/file.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>pathlib</strong> will translate the relative path you have entered into whatever the local operating system needs.</p>
<p>Setting up Visual Studio Code so that Python interactive windows and terminals start in the current folder, typically your project’s root directory, makes it easier to use relative filepaths.</p>
<div class="admonition-start-interactive-windows-and-terminals-within-your-project-directory admonition">
<p class="admonition-title">Start interactive windows and terminals within your project directory</p>
<p>In Visual Studio Code, you can ensure that the interactive window starts in the root directory of your project by setting “Jupyter: Notebook File Root” to <code class="docutils literal notranslate"><span class="pre">${workspaceFolder}</span></code> in the Settings menu. For the integrated command line, change “Terminal › Integrated: Cwd” to <code class="docutils literal notranslate"><span class="pre">${workspaceFolder}</span></code> too.</p>
</div>
</section>
<section id="rubber-duck-your-problems">
<h3>Rubber duck your problems<a class="headerlink" href="#rubber-duck-your-problems" title="Link to this heading">#</a></h3>
<p>Rubber duck debugging is a method of fixing code that isn’t working as intended by, err, talking to a rubber duck. Something about describing your problem out loud and in detail can suddenly illuminate the issue to you and your plastic waterfowl friend.</p>
<p>🦆</p>
</section>
<section id="the-zen-of-python">
<h3>The Zen of Python<a class="headerlink" href="#the-zen-of-python" title="Link to this heading">#</a></h3>
<p>For a more poetic take on how to code, <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">this</span></code> in your Python session.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">this</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren&#39;t special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you&#39;re Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it&#39;s a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let&#39;s do more of those!
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="advanced-coding-tips">
<h2>Advanced Coding Tips<a class="headerlink" href="#advanced-coding-tips" title="Link to this heading">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are just learning to code you should feel free to skip this section for now.</p>
</div>
<p>There are many other coding tips that are useful but that make use of concepts or tools that we haven’t met yet. To be comprehensive, they are included here—but we’ll be seeing most of them in the other coding chapters.</p>
<section id="version-control">
<h3>Version Control<a class="headerlink" href="#version-control" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Control versions of your code using Git, which is the standard for research, industry, and everyone on planet Earth.</p></li>
<li><p>Code should be committed regularly, preferably when a discrete unit of work has been completed.</p></li>
<li><p>Continuous integration, for example using tools such as GitHub Actions, should be used to ensure that each change is integrated into the workflow smoothly.</p></li>
</ul>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Credentials and other secrets are not written in code but are configured as environment variables.</p></li>
<li><p>Configuration as applied to code or simulations is written as code, but is clearly separated from code used for analysis.</p></li>
<li><p>The configuration used to generate particular outputs, releases and publications is recorded.</p></li>
<li><p>If appropriate, multiple configuration files are used and interchangeable depending on system/local/user.</p></li>
</ul>
</section>
<section id="environments">
<h3>Environments<a class="headerlink" href="#environments" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Code environments are reproducible and development is done within a consistent code environment.</p></li>
</ul>
</section>
<section id="project-management">
<h3>Project management<a class="headerlink" href="#project-management" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The roles and responsibilities of team members are clearly defined.</p></li>
<li><p>An issue tracker (e.g GitHub Project, Trello, or Jira) is used to record development tasks.</p></li>
</ul>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Core functionality is unit tested as code.</p></li>
<li><p>Code based tests are run regularly and before each commit (for example using pre-commit).</p></li>
<li><p>Bug fixes include implementing new unit tests to ensure that the same bug does not reoccur.</p></li>
<li><p>Tests are automatically run and recorded using continuous integration.</p></li>
<li><p>The whole process is tested from start to finish using one or more realistic end-to-end tests.</p></li>
<li><p>Test code is clean an readable.</p></li>
</ul>
</section>
</section>
<section id="review">
<h2>Review<a class="headerlink" href="#review" title="Link to this heading">#</a></h2>
<p>From this chapter, you should remember to</p>
<ul class="simple">
<li><p>✅ know what a code style is;</p></li>
<li><p>✅ not repeat yourself;</p></li>
<li><p>✅ be consistent with your naming convention;</p></li>
<li><p>✅ write modular, well-documented code;</p></li>
<li><p>✅ use interoperable file formats;</p></li>
<li><p>✅ use relative file paths; and</p></li>
<li><p>✅ stay zen!</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="data-spreadsheets.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Spreadsheets</p>
      </div>
    </a>
    <a class="right-next"
       href="code-advanced.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Coding</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-code-in-style">How to Code in Style</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-in-a-name">What’s in a name?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whitespace">Whitespace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-width-and-line-continuation">Line width and line continuation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principles-of-clean-code">Principles of Clean Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-not-repeat-yourself-dry">Do not repeat yourself (DRY)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kiss-keep-it-simple-stupid">KISS (Keep It Simple, Stupid)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#soc-separation-of-concerns-make-it-modular">SoC (Separation of Concerns) / Make it Modular</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-comments">Code Comments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-review">Code Review</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-prematurely-optimise-for-speed">Don’t prematurely optimise for speed</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-interoperable-file-formats">Use interoperable file formats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-relative-filepaths">Use relative filepaths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rubber-duck-your-problems">Rubber duck your problems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-zen-of-python">The Zen of Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-coding-tips">Advanced Coding Tips</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#version-control">Version Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#environments">Environments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-management">Project management</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review">Review</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Arthur Turrell
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  This book is available under an MIT license.
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>